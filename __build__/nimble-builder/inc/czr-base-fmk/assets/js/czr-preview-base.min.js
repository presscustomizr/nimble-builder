!function(s,r,a){if(wp.customize.bind("preview-ready",function(){}),serverPreviewParams&&!serverPreviewParams.preview_ready_event_exists)try{s.czr_preview=new s.CZR_preview}catch(e){console.log("new api.CZR_preview() => error => ",e)}else s.bind("preview-ready",function(){s.preview.bind("active",function(){try{s.czr_preview=new s.CZR_preview}catch(e){console.log("new api.CZR_preview() => error => ",e)}})});var e={setting_cbs:{},subsetting_cbs:{},input_cbs:{},initialize:function(){var e=this;this.pre_setting_cbs=a.extend(e.pre_setting_cbs,e.getPreSettingCbs()),this.setting_cbs=a.extend(e.setting_cbs,e.getSettingCbs()),this.subsetting_cbs=a.extend(e.subsetting_cbs,e.getSubSettingCbs()),this.input_cbs=a.extend(e.input_cbs,e.getInputCbs()),this.syncData(),this.addCbs(),r("body").removeClass("wp-customizer-unloading")},getPreSettingCbs:function(){return{}},getSettingCbs:function(){return{}},getSubSettingCbs:function(){return{}},getInputCbs:function(){return{}},syncData:function(){s.preview.send("czr-query-data-ready",s.settings.czr_wpQueryInfos),s.preview.send("czr-partial-refresh-data","undefined"==typeof _customizePartialRefreshExports?{}:_customizePartialRefreshExports.partials)},addCbs:function(){var n=this;s.preview.bind("pre_setting",function(e){var t=(e=e||{}).set_id;if(s.has(n._build_setId(t))){var i=n._get_option_name(e.set_id);a.has(n.pre_setting_cbs,i)&&a.isFunction(n.pre_setting_cbs[i])&&n.pre_setting_cbs[i](e)}}),a.each(n.setting_cbs,function(e,t){s.has(n._build_setId(t))&&a.isFunction(n.setting_cbs[t])&&s(n._build_setId(t)).bind(n.setting_cbs[t])}),s.preview.bind("sub_setting",function(e){var t=n._get_option_name(e.set_id);a.has(n.subsetting_cbs,t)&&a.has(n.subsetting_cbs[t],e.changed_prop)&&n.subsetting_cbs[t][e.changed_prop](e)}),s.preview.bind("czr_input",function(e){e=a.extend({set_id:"",module_id:"",item_id:"",input_id:"",value:null},e);var t=n._get_option_name(e.set_id);a.has(n.input_cbs,t)&&a.has(n.input_cbs[t],e.input_id)&&n.input_cbs[t][e.input_id](e)}),s.selectiveRefresh.bind("partial-content-rendered",function(e){if(a.has(e,"partial")&&a.has(e.partial,"id")){e.partial.id;s.preview.send("czr-partial-refresh-done",{set_id:n._build_setId(e.partial.id)})}})},_build_setId:function(e){if(a.isEmpty(window.themeServerPreviewParams))return e;if(!a.isArray(themeServerPreviewParams.wpBuiltinSettings)||a.contains(themeServerPreviewParams.wpBuiltinSettings,e))return e;var t=themeServerPreviewParams.themeOptionsPrefix;return a.isEmpty(t)?e:-1==e.indexOf(t)?[t+"[",e,"]"].join(""):e},_get_option_name:function(e){if(a.isEmpty(window.themeServerPreviewParams))return e;var t=themeServerPreviewParams.themeOptionsPrefix;if(a.isEmpty(t))return e;return e.replace(/\[|\]/g,"").replace(t,"")},_is_external:function(e){var t=r.trim(e),i=location.host.split(".").slice(-2).join("."),n=new RegExp(i);if(""!==t&&"#"!=t&&_isValidURL(t))return!n.test(t)},_isValidURL:function(e){return/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}};s.CZR_preview=s.Class.extend(e)}(wp.customize,jQuery,_);