!function(r,t,s){if(wp.customize.bind("preview-ready",function(){}),serverPreviewParams&&!serverPreviewParams.preview_ready_event_exists)try{r.czr_preview=new r.CZR_preview}catch(e){console.log("new api.CZR_preview() => error => ",e)}else r.bind("preview-ready",function(){r.preview.bind("active",function(){try{r.czr_preview=new r.CZR_preview}catch(e){console.log("new api.CZR_preview() => error => ",e)}})});var e={setting_cbs:{},subsetting_cbs:{},input_cbs:{},initialize:function(){var e=this;this.pre_setting_cbs=s.extend(e.pre_setting_cbs,e.getPreSettingCbs()),this.setting_cbs=s.extend(e.setting_cbs,e.getSettingCbs()),this.subsetting_cbs=s.extend(e.subsetting_cbs,e.getSubSettingCbs()),this.input_cbs=s.extend(e.input_cbs,e.getInputCbs()),this.syncData(),this.addCbs(),t("body").removeClass("wp-customizer-unloading")},getPreSettingCbs:function(){return{}},getSettingCbs:function(){return{}},getSubSettingCbs:function(){return{}},getInputCbs:function(){return{}},syncData:function(){r.preview.send("czr-query-data-ready",r.settings.czr_wpQueryInfos),r.preview.send("czr-partial-refresh-data","undefined"==typeof _customizePartialRefreshExports?{}:_customizePartialRefreshExports.partials)},addCbs:function(){var n=this;r.preview.bind("pre_setting",function(e){var t=(e=e||{}).set_id;if(r.has(n._build_setId(t))){var i=n._get_option_name(e.set_id);s.has(n.pre_setting_cbs,i)&&s.isFunction(n.pre_setting_cbs[i])&&n.pre_setting_cbs[i](e)}}),s.each(n.setting_cbs,function(e,t){r.has(n._build_setId(t))&&s.isFunction(n.setting_cbs[t])&&r(n._build_setId(t)).bind(n.setting_cbs[t])}),r.preview.bind("sub_setting",function(e){var t=n._get_option_name(e.set_id);s.has(n.subsetting_cbs,t)&&s.has(n.subsetting_cbs[t],e.changed_prop)&&n.subsetting_cbs[t][e.changed_prop](e)}),r.preview.bind("czr_input",function(e){e=s.extend({set_id:"",module_id:"",item_id:"",input_id:"",value:null},e);var t=n._get_option_name(e.set_id);s.has(n.input_cbs,t)&&s.has(n.input_cbs[t],e.input_id)&&n.input_cbs[t][e.input_id](e)}),r.selectiveRefresh.bind("partial-content-rendered",function(e){if(s.has(e,"partial")&&s.has(e.partial,"id")){e.partial.id;r.preview.send("czr-partial-refresh-done",{set_id:n._build_setId(e.partial.id)})}})},_build_setId:function(e){if(s.isEmpty(window.themeServerPreviewParams))return e;if(!s.isArray(themeServerPreviewParams.wpBuiltinSettings)||s.contains(themeServerPreviewParams.wpBuiltinSettings,e))return e;var t=themeServerPreviewParams.themeOptionsPrefix;return s.isEmpty(t)?e:-1==e.indexOf(t)?[t+"[",e,"]"].join(""):e},_get_option_name:function(e){if(s.isEmpty(window.themeServerPreviewParams))return e;var t=themeServerPreviewParams.themeOptionsPrefix;if(s.isEmpty(t))return e;return e.replace(/\[|\]/g,"").replace(t,"")},_is_external:function(e){if("string"!=typeof e)return!1;var t=e.trim(),i=location.host.split(".").slice(-2).join("."),n=new RegExp(i);return!(""===t||"#"==t||!_isValidURL(t))&&!n.test(t)},_isValidURL:function(e){return/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}};r.CZR_preview=r.Class.extend(e)}(wp.customize,jQuery,_);