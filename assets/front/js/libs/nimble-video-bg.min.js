window,document,nb_.listenTo("nb-app-ready",function(){!function(l,o){var n="nimbleLoadVideoBg",a={bgVideoContainerClass:"sek-bg-video-wrapper",bgYoutubeVideoContainerClass:"sek-bg-youtube-video-wrapper",bgLocalVideoContainerClass:"sek-background-video-local",bgLoadingClass:"sek-bg-loading",loop:!0,delayBeforeStart:null,activeOnMobile:!1,startAt:null,endAt:null,lazyLoad:!1};function i(e,i){var t=this;this.$element=l(e),this.$window=nb_.cachedElements.$window,this._defaults=a,this._name=n,this.options=nb_.isObject(i)?i:{},this.videoPlayer=!1,this.options.lazyLoad?(nb_.cachedElements.$window.on("scroll",nb_.throttle(function(e){nb_.elOrFirstVisibleParentIsInWindow(t.$element)&&!t.$element.data("sek-player-instantiated")&&!1===t.videoPlayer&&t.initSetup()},50)),nb_.cachedElements.$window.on("resize",nb_.debounce(function(e){nb_.elOrFirstVisibleParentIsInWindow(t.$element)&&!t.$element.data("sek-player-instantiated")&&!1===t.videoPlayer&&t.initSetup()},100)),nb_.elOrFirstVisibleParentIsInWindow(t.$element)&&!t.$element.data("sek-player-instantiated")&&!1===t.videoPlayer&&t.initSetup()):!1===t.videoPlayer&&t.initSetup()}i.prototype.initSetup=function(){var e=this;nb_.isUndefined(e.$element.data("sek-video-bg-loop"))||(this.options.loop=e.$element.data("sek-video-bg-loop")),this.options.delayBeforeStart=e.$element.data("sek-video-delay-before"),this.options.delayBeforeStart=Math.abs(e.options.delayBeforeStart?parseInt(e.options.delayBeforeStart,10):0),nb_.isUndefined(e.$element.data("sek-video-bg-on-mobile"))||(this.options.activeOnMobile=e.$element.data("sek-video-bg-on-mobile")),this.options.startAt=e.$element.data("sek-video-start-at"),this.options.startAt=Math.abs(e.options.startAt?parseInt(e.options.startAt,10):0),this.options.endAt=e.$element.data("sek-video-end-at"),this.options.endAt=Math.abs(e.options.endAt?parseInt(e.options.endAt,10):0),this.isFragmentedVideo=!1;var i=this.options.startAt,t=this.options.endAt;(i||t)&&(i&&t<1?this.isFragmentedVideo=!0:i&&t&&i<t?this.isFragmentedVideo=!0:i<1&&t&&(this.isFragmentedVideo=!0)),this.options=l.extend({},a,this.options),nb_.delay(function(){e.init(),e.$element.on("refresh-video-dimensions",nb_.debounce(function(){nb_.delay(function(){e.updatePlayerDimensions()},300)},200)),e.$element.data("sek-player-instantiated",!0)},1e3*e.options.delayBeforeStart)},i.prototype._better_scroll_event_handler=function(e,i){var t=this;this.doingAnimation||(this.doingAnimation=!0,o.requestAnimationFrame(function(){t._maybe_trigger_load(e,i),t.doingAnimation=!1}))},i.prototype.init=function(){var i=this;(nb_.isCustomizing()||this.options.activeOnMobile||!nb_.isMobile())&&(this.videoUrl=i.$element.data("sek-video-bg-src"),-1!==this.videoUrl.indexOf("vimeo.com")?(this.videoOrigin="vimeo",this.videoApiHelpers=this.getVideoApiHelpers("vimeo")):this.videoUrl.match(/^(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com)/)&&(this.videoOrigin="youtube",this.videoApiHelpers=this.getVideoApiHelpers("youtube")),(nb_.isUndefined(i.$backgroundVideoContainer)||i.$backgroundVideoContainer.length<1)&&(i.$element.children().first().before(l("<div>",{class:i.options.bgVideoContainerClass})),i.$backgroundVideoContainer=l("."+i.options.bgVideoContainerClass,i.$element)),this.videoApiHelpers?(i.$backgroundVideoContainer.append(l("<div>",{class:i.options.bgYoutubeVideoContainerClass})),this.videoId=this.videoApiHelpers.getVideoIDFromURL(this.videoUrl),this.videoId&&this.videoApiHelpers.onApiReady(function(e){i.apiInstance=e,"youtube"===i.videoOrigin&&i.setupYtubeVideo(),"vimeo"===i.videoOrigin&&i.setupVimeoVideo()})):(this.videoOrigin="local",i.setupLocalVideo()),this.$window.on("resize",nb_.debounce(function(){i.updatePlayerDimensions()},200)))},i.prototype.setupLocalVideo=function(){var e=this,i=["autoplay","muted","playsinline"];e.options.loop&&i.push("loop"),i=i.join(" "),e.$backgroundVideoContainer.find("video").length<1&&e.$backgroundVideoContainer.append("<video "+i+' class="'+e.options.bgLocalVideoContainerClass+'"></video>'),e.$backgroundVideoLocal=l("."+e.options.bgLocalVideoContainerClass,e.$element),e.videoPlayer=e.$backgroundVideoLocal;var t=e.options.startAt,o=e.options.endAt;this.isFragmentedVideo&&(t&&o<1?this.videoUrl+="#t="+t:t&&o&&t<o?this.videoUrl+="#t="+t+","+o:t<1&&o&&(this.videoUrl+="#t=0,"+o)),e.$backgroundVideoContainer.find("."+e.options.bgLocalVideoContainerClass).attr("src",this.videoUrl).one("canplay",function(){e.updatePlayerDimensions(),e.$backgroundVideoContainer.css("opacity",1)});var n=-1!==this.videoUrl.indexOf("#t=");e.options.loop&&n?e.videoPlayer.on("timeupdate",nb_.throttle(function(){this.currentTime>o&&(this.currentTime=t,this.play())},100)):e.videoPlayer.on("ended",function(){e.videoPlayer.hide()})},i.prototype.setupYtubeVideo=function(){var o=this,n=function(e){if(e.videoPlayer.getIframe().contentWindow){var i=o.options.startAt,t=o.options.endAt;o.options.loop||e.initial?(e.videoPlayer.seekTo(i),t&&setTimeout(function(){n({initial:!1,videoPlayer:e.videoPlayer})},1e3*(t-i+1))):e.videoPlayer.stopVideo()}},i=o.apiInstance.PlayerState.UNSTARTED;o.$backgroundVideoContainer.addClass(o.options.bgLoadingClass),this.videoPlayer=new o.apiInstance.Player(o.$backgroundVideoContainer.find("."+o.options.bgYoutubeVideoContainerClass)[0],{videoId:o.videoId,events:{onReady:function(){o.videoPlayer.mute(),o.updatePlayerDimensions(),o.isFragmentedVideo&&n({initial:!0,videoPlayer:o.videoPlayer}),o.videoPlayer.playVideo()},onStateChange:function(e){switch(e.data){case i:o.$backgroundVideoContainer.removeClass(o.options.bgLoadingClass),o.$backgroundVideoContainer.css("opacity",1);break;case o.apiInstance.PlayerState.ENDED:o.videoPlayer.seekTo(o.options.startAt),o.options.loop||o.videoPlayer.destroy()}}},playerVars:{controls:0,rel:0}})},i.prototype.setupVimeoVideo=function(){var t,o,n=this;n.$backgroundVideoContainer.addClass(n.options.bgLoadingClass),this.videoPlayer=new n.apiInstance.Player(n.$backgroundVideoContainer,{id:n.videoId,width:n.$backgroundVideoContainer.outerWidth().width,autoplay:!0,loop:n.options.loop,transparent:!1,playsinline:!1,background:!0,muted:!0,controls:!1}),this.isFragmentedVideo&&(t=n.options.startAt,o=n.options.endAt,t&&n.videoPlayer.on("play",function(e){0===e.seconds&&n.videoPlayer.setCurrentTime(t)}),n.videoPlayer.on("timeupdate",function(i){o&&o<i.seconds&&(n.options.loop?n.videoPlayer.setCurrentTime(t):n.videoPlayer.pause()),n.videoPlayer.getDuration().then(function(e){t&&!o&&i.seconds>e-.5&&n.videoPlayer.setCurrentTime(t)})})),this.videoPlayer.ready().then(function(){l(n.videoPlayer.element).addClass("sek-background-vimeo-element"),n.updatePlayerDimensions(),nb_.delay(function(){n.$backgroundVideoContainer.removeClass(n.options.bgLoadingClass),n.$backgroundVideoContainer.css("opacity",1)},200)})},i.prototype.updatePlayerDimensions=function(){var e;if(("local"===this.videoOrigin||this.videoPlayer)&&("youtube"===this.videoOrigin?e=l(this.videoPlayer.getIframe()):"vimeo"===this.videoOrigin?e=l(this.videoPlayer.element):"local"===this.videoOrigin&&(e=this.videoPlayer),e)){var i="16:9";"vimeo"===this.videoOrigin&&(i=e[0].width+":"+e[0].height);var t=this.$backgroundVideoContainer.outerWidth(),o=this.$backgroundVideoContainer.outerHeight(),n=i.split(":"),a=n[0]/n[1],s=t/a,d=o*a,r=a<t/o;e.width(r?t:d).height(r?s:o)}},i.prototype.getVideoApiHelpers=function(t){return{insertAPI:function(){l("script:first").before(l("<script>",{src:"youtube"===t?"https://www.youtube.com/iframe_api":"https://player.vimeo.com/api/player.js",id:"sek-"+t+"-api"}))},getVideoIDFromURL:function(e){if(null==e)return null;if("youtube"!==t)return e=e.split("?")[0],parseInt(e.substring(e.lastIndexOf("/")+1),10);var i=e.match(/^(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com\/(?:(?:watch)?\?(?:.*&)?vi?=|(?:embed|v|vi|user)\/))([^?&"'>]+)/);return i&&i[1]},onApiReady:function(e){var i=this;l("#sek-"+t+"-api").length<1&&this.insertAPI(),("youtube"===t?o.YT&&YT.loaded:o.Vimeo)?e("youtube"===t?YT:Vimeo):setTimeout(function(){i.onApiReady(e)},350)}}},l.fn[n]=function(e){return this.each(function(){l.data(this,"plugin_"+n)||l.data(this,"plugin_"+n,new i(this,e))})}}(jQuery,window),jQuery(function(o){var t=function(){o("[data-sek-video-bg-src]").each(function(){"section"!==o(this).data("sek-level")&&"column"!==o(this).data("sek-level")||o(this).data("sek-player-instantiated")||o(this).nimbleLoadVideoBg({lazyLoad:sekFrontLocalized.video_bg_lazyload_enabled})})};t(),nb_.cachedElements.$body.on("sek-section-added sek-columns-refreshed",function(e,i){t()}),nb_.cachedElements.$body.on("sek-modules-refreshed",function(e,i){o("[data-sek-video-bg-src]").each(function(){o(this).trigger("refresh-video-dimensions")})}),nb_.cachedElements.$body.on("sek-level-refreshed",function(e,i){if(i&&nb_.isObject(i)&&i.id){var t=o('[data-sek-id="'+i.id+'"][data-sek-video-bg-src]');0<t.length&&!t.data("sek-player-instantiated")&&t.nimbleLoadVideoBg({lazyLoad:sekFrontLocalized.video_bg_lazyload_enabled})}})}),nb_.emit("nb-videobg-parsed")});