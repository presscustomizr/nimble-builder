window,document,nb_.listenTo("nimble-app-ready",function(){!function(l,t){var n="nimbleLoadVideoBg",a={bgVideoContainerClass:"sek-bg-video-wrapper",bgYoutubeVideoContainerClass:"sek-bg-youtube-video-wrapper",bgLocalVideoContainerClass:"sek-background-video-local",bgLoadingClass:"sek-bg-loading",loop:!0,delayBeforeStart:null,activeOnMobile:!1,startAt:null,endAt:null,lazyLoad:!1};function i(e,i){var o=this;this.$element=l(e),this.$window=nb_.cachedElements.$window,this._defaults=a,this._name=n,this.options=nb_.isObject(i)?i:{},this.videoPlayer=!1,this.options.lazyLoad?(nb_.cachedElements.$window.scroll(nb_.throttle(function(e){nb_.isInWindow(o.$element)&&!o.$element.data("sek-player-instantiated")&&!1===o.videoPlayer&&o.initSetup()},50)),nb_.cachedElements.$window.resize(nb_.debounce(function(e){nb_.isInWindow(o.$element)&&!o.$element.data("sek-player-instantiated")&&!1===o.videoPlayer&&o.initSetup()},100)),nb_.isInWindow(o.$element)&&!o.$element.data("sek-player-instantiated")&&!1===o.videoPlayer&&o.initSetup()):!1===o.videoPlayer&&o.initSetup()}i.prototype.initSetup=function(){var e=this;nb_.isUndefined(e.$element.data("sek-video-bg-loop"))||(this.options.loop=e.$element.data("sek-video-bg-loop")),this.options.delayBeforeStart=e.$element.data("sek-video-delay-before"),this.options.delayBeforeStart=Math.abs(e.options.delayBeforeStart?parseInt(e.options.delayBeforeStart,10):0),nb_.isUndefined(e.$element.data("sek-video-bg-on-mobile"))||(this.options.activeOnMobile=e.$element.data("sek-video-bg-on-mobile")),this.options.startAt=e.$element.data("sek-video-start-at"),this.options.startAt=Math.abs(e.options.startAt?parseInt(e.options.startAt,10):0),this.options.endAt=e.$element.data("sek-video-end-at"),this.options.endAt=Math.abs(e.options.endAt?parseInt(e.options.endAt,10):0),this.isFragmentedVideo=!1;var i=this.options.startAt,o=this.options.endAt;(i||o)&&(i&&o<1?this.isFragmentedVideo=!0:i&&o&&i<o?this.isFragmentedVideo=!0:i<1&&o&&(this.isFragmentedVideo=!0)),this.options=l.extend({},a,this.options),nb_.delay(function(){e.init(),e.$element.on("refresh-video-dimensions",nb_.debounce(function(){nb_.delay(function(){e.updatePlayerDimensions()},300)},200)),e.$element.data("sek-player-instantiated",!0)},1e3*e.options.delayBeforeStart)},i.prototype._better_scroll_event_handler=function(e,i){var o=this;this.doingAnimation||(this.doingAnimation=!0,t.requestAnimationFrame(function(){o._maybe_trigger_load(e,i),o.doingAnimation=!1}))},i.prototype.init=function(){var i=this;(nb_.isCustomizing()||this.options.activeOnMobile||!nb_.isMobile())&&(this.videoUrl=i.$element.data("sek-video-bg-src"),-1!==this.videoUrl.indexOf("vimeo.com")?(this.videoOrigin="vimeo",this.videoApiHelpers=this.getVideoApiHelpers("vimeo")):this.videoUrl.match(/^(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com)/)&&(this.videoOrigin="youtube",this.videoApiHelpers=this.getVideoApiHelpers("youtube")),(nb_.isUndefined(i.$backgroundVideoContainer)||i.$backgroundVideoContainer.length<1)&&(i.$element.children().first().before(l("<div>",{class:i.options.bgVideoContainerClass})),i.$backgroundVideoContainer=l("."+i.options.bgVideoContainerClass,i.$element)),this.videoApiHelpers?(i.$backgroundVideoContainer.append(l("<div>",{class:i.options.bgYoutubeVideoContainerClass})),this.videoId=this.videoApiHelpers.getVideoIDFromURL(this.videoUrl),this.videoId&&this.videoApiHelpers.onApiReady(function(e){i.apiInstance=e,"youtube"===i.videoOrigin&&i.setupYtubeVideo(),"vimeo"===i.videoOrigin&&i.setupVimeoVideo()})):(this.videoOrigin="local",i.setupLocalVideo()),this.$window.on("resize",nb_.debounce(function(){i.updatePlayerDimensions()},200)))},i.prototype.setupLocalVideo=function(){var e=this,i=["autoplay","muted","playsinline"];e.options.loop&&i.push("loop"),i=i.join(" "),e.$backgroundVideoContainer.find("video").length<1&&e.$backgroundVideoContainer.append("<video "+i+' class="'+e.options.bgLocalVideoContainerClass+'"></video>'),e.$backgroundVideoLocal=l("."+e.options.bgLocalVideoContainerClass,e.$element),e.videoPlayer=e.$backgroundVideoLocal;var o=e.options.startAt,t=e.options.endAt;this.isFragmentedVideo&&(o&&t<1?this.videoUrl+="#t="+o:o&&t&&o<t?this.videoUrl+="#t="+o+","+t:o<1&&t&&(this.videoUrl+="#t=0,"+t)),e.$backgroundVideoContainer.find("."+e.options.bgLocalVideoContainerClass).attr("src",this.videoUrl).one("canplay",function(){e.updatePlayerDimensions(),e.$backgroundVideoContainer.css("opacity",1)});var n=-1!==this.videoUrl.indexOf("#t=");e.options.loop&&n?e.videoPlayer.on("timeupdate",nb_.throttle(function(){this.currentTime>t&&(this.currentTime=o,this.play())},100)):e.videoPlayer.on("ended",function(){e.videoPlayer.hide()})},i.prototype.setupYtubeVideo=function(){var t=this,n=function(e){if(e.videoPlayer.getIframe().contentWindow){var i=t.options.startAt,o=t.options.endAt;t.options.loop||e.initial?(e.videoPlayer.seekTo(i),o&&setTimeout(function(){n({initial:!1,videoPlayer:e.videoPlayer})},1e3*(o-i+1))):e.videoPlayer.stopVideo()}},i=t.apiInstance.PlayerState.UNSTARTED;t.$backgroundVideoContainer.addClass(t.options.bgLoadingClass),this.videoPlayer=new t.apiInstance.Player(t.$backgroundVideoContainer.find("."+t.options.bgYoutubeVideoContainerClass)[0],{videoId:t.videoId,events:{onReady:function(){t.videoPlayer.mute(),t.updatePlayerDimensions(),t.isFragmentedVideo&&n({initial:!0,videoPlayer:t.videoPlayer}),t.videoPlayer.playVideo()},onStateChange:function(e){switch(e.data){case i:t.$backgroundVideoContainer.removeClass(t.options.bgLoadingClass),t.$backgroundVideoContainer.css("opacity",1);break;case t.apiInstance.PlayerState.ENDED:t.videoPlayer.seekTo(t.options.startAt),t.options.loop||t.videoPlayer.destroy()}}},playerVars:{controls:0,rel:0}})},i.prototype.setupVimeoVideo=function(){var o,t,n=this;n.$backgroundVideoContainer.addClass(n.options.bgLoadingClass),this.videoPlayer=new n.apiInstance.Player(n.$backgroundVideoContainer,{id:n.videoId,width:n.$backgroundVideoContainer.outerWidth().width,autoplay:!0,loop:n.options.loop,transparent:!1,playsinline:!1,background:!0,muted:!0,controls:!1}),this.isFragmentedVideo&&(o=n.options.startAt,t=n.options.endAt,o&&n.videoPlayer.on("play",function(e){0===e.seconds&&n.videoPlayer.setCurrentTime(o)}),n.videoPlayer.on("timeupdate",function(i){t&&t<i.seconds&&(n.options.loop?n.videoPlayer.setCurrentTime(o):n.videoPlayer.pause()),n.videoPlayer.getDuration().then(function(e){o&&!t&&i.seconds>e-.5&&n.videoPlayer.setCurrentTime(o)})})),this.videoPlayer.ready().then(function(){l(n.videoPlayer.element).addClass("sek-background-vimeo-element"),n.updatePlayerDimensions(),nb_.delay(function(){n.$backgroundVideoContainer.removeClass(n.options.bgLoadingClass),n.$backgroundVideoContainer.css("opacity",1)},200)})},i.prototype.updatePlayerDimensions=function(){var e;if(("local"===this.videoOrigin||this.videoPlayer)&&("youtube"===this.videoOrigin?e=l(this.videoPlayer.getIframe()):"vimeo"===this.videoOrigin?e=l(this.videoPlayer.element):"local"===this.videoOrigin&&(e=this.videoPlayer),e)){var i="16:9";"vimeo"===this.videoOrigin&&(i=e[0].width+":"+e[0].height);var o=this.$backgroundVideoContainer.outerWidth(),t=this.$backgroundVideoContainer.outerHeight(),n=i.split(":"),a=n[0]/n[1],s=o/a,d=t*a,r=a<o/t;e.width(r?o:d).height(r?s:t)}},i.prototype.getVideoApiHelpers=function(o){return{insertAPI:function(){l("script:first").before(l("<script>",{src:"youtube"===o?"https://www.youtube.com/iframe_api":"https://player.vimeo.com/api/player.js",id:"sek-"+o+"-api"}))},getVideoIDFromURL:function(e){if(null==e)return null;if("youtube"!==o)return e=e.split("?")[0],parseInt(e.substring(e.lastIndexOf("/")+1),10);var i=e.match(/^(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com\/(?:(?:watch)?\?(?:.*&)?vi?=|(?:embed|v|vi|user)\/))([^?&"'>]+)/);return i&&i[1]},onApiReady:function(e){var i=this;l("#sek-"+o+"-api").length<1&&this.insertAPI(),("youtube"===o?t.YT&&YT.loaded:t.Vimeo)?e("youtube"===o?YT:Vimeo):setTimeout(function(){i.onApiReady(e)},350)}}},l.fn[n]=function(e){return this.each(function(){l.data(this,"plugin_"+n)||l.data(this,"plugin_"+n,new i(this,e))})}}(jQuery,window),jQuery(function(t){var o=function(){t("[data-sek-video-bg-src]").each(function(){"section"!==t(this).data("sek-level")&&"column"!==t(this).data("sek-level")||t(this).data("sek-player-instantiated")||t(this).nimbleLoadVideoBg({lazyLoad:sekFrontLocalized.video_bg_lazyload_enabled})})};o(),nb_.cachedElements.$body.on("sek-section-added sek-columns-refreshed",function(e,i){o()}),nb_.cachedElements.$body.on("sek-modules-refreshed",function(e,i){t("[data-sek-video-bg-src]").each(function(){t(this).trigger("refresh-video-dimensions")})}),nb_.cachedElements.$body.on("sek-level-refreshed",function(e,i){if(i&&nb_.isObject(i)&&i.id){var o=t('[data-sek-id="'+i.id+'"][data-sek-video-bg-src]');0<o.length&&!o.data("sek-player-instantiated")&&o.nimbleLoadVideoBg({lazyLoad:sekFrontLocalized.video_bg_lazyload_enabled})}})}),nb_.emit("nimble-video-bg-ready")});