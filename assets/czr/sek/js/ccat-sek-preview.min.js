var SekPreviewPrototype=SekPreviewPrototype||{};!function(t,s,a){s.extend(SekPreviewPrototype,{initialize:function(){var e=this;try{this.skope_id=a.findWhere(_wpCustomizeSettings.czr_new_skopes,{skope:"local"}).skope_id}catch(e){return void this.errare("Preview => error when storing the skope_id",e)}this.scheduleHighlightActiveLevel(),e.setupLoader(),s(function(){e.setupSortable(),e.setupResizable(),e.setupUiHoverVisibility(),e.scheduleUiClickReactions(),e.schedulePanelMsgReactions()})},scheduleHighlightActiveLevel:function(){var n=this;this.activeLevelUI=new t.Value(""),this.activeUIChangedRecently=new t.Value(!1),this.activeLevelUI.bind(function(e,t){var a=s('[data-sek-id="'+e+'"]'),i=s('[data-sek-id="'+t+'"]');0<a.length&&a.addClass("sek-active-ui sek-highlight-active-ui"),0<i.length&&i.removeClass("sek-active-ui sek-highlight-active-ui"),n.activeUIChangedRecently(Date.now())}),a.each(["sek-refresh-stylesheet","sek-refresh-level"],function(e){t.preview.bind(e,function(e){n.activeUIChangedRecently(Date.now())})}),this.activeUIChangedRecently.bind(function(e){var t=s('[data-sek-id="'+n.activeLevelUI()+'"]');s(".sek-highlight-active-ui").length&&s(".sek-highlight-active-ui").removeClass("sek-highlight-active-ui"),0<t.length&&t.toggleClass("sek-highlight-active-ui",!1!==e),clearTimeout(s.data(this,"_ui_change_timer_")),s.data(this,"_ui_change_timer_",setTimeout(function(){n.activeUIChangedRecently(!1)},3e3))})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(l,c,k){c.extend(SekPreviewPrototype,{setupSortable:function(){var a=this;return this.sortableDefaultParams={placeholder:"sortable-placeholder",over:function(e,t){}},c('[data-sek-level="location"]').each(function(){a.makeSektionsSortableInLocation(c(this).data("sek-id"))}),c("body").on("sek-section-added sek-level-refreshed",'[data-sek-level="location"]',function(e,t){a.makeSektionsSortableInLocation(c(this).data("sek-id"))}),c('[data-sek-level="location"]').each(function(){c(this).find('[data-sek-level="section"]').each(function(){a.makeColumnsSortableInSektion(c(this).data("sek-id"))})}),c("body").on("sek-columns-refreshed sek-section-added",'[data-sek-level="section"]',function(e){a.makeColumnsSortableInSektion(c(this).data("sek-id"))}),c('[data-sek-level="location"]').each(function(){c(this).find('[data-sek-level="column"]').each(function(){a.makeModulesSortableInColumn(c(this).data("sek-id"))})}),c("body").on("sek-modules-refreshed",'[data-sek-level="column"]',function(){a.makeModulesSortableInColumn(c(this).data("sek-id"))}),c("body").on("sek-columns-refreshed",'[data-sek-level="section"]',function(){c(this).find(".sek-sektion-inner").first().children('[data-sek-level="column"]').each(function(){a.makeModulesSortableInColumn(c(this).data("sek-id"))})}),this},makeSektionsSortableInLocation:function(e){var a,i,t,n=this,s=[],o=[];c('[data-sek-id="'+e+'"]').each(function(){t=c.extend(!0,{},n.sortableDefaultParams),c(this).sortable(k.extend(t,{handle:".sek-move-section",connectWith:'[data-sek-level="location"]',placeholder:{element:function(e){return c('<div class="sortable-placeholder"><div class="sek-module-placeholder-content"><p>'+sekPreviewLocalized.i18n["Insert here"]+"</p></div></div>")[0]},update:function(e,t){}},start:function(e,t){c("body").addClass("sek-moving-section"),$sourceLocation=t.item.closest('[data-sek-level="location"]'),a=$sourceLocation.data("sek-id"),$sourceLocation.children('[data-sek-level="section"]').each(function(){s.push(c(this).data("sek-id"))})},stop:function(e,t){c("body").removeClass("sek-moving-section"),o=[],$targetLocation=t.item.closest('[data-sek-level="location"]'),i=$targetLocation.data("sek-id"),$targetLocation.children('[data-sek-level="section"]').each(function(){o.push(c(this).data("sek-id"))}),l.preview.send("sek-move",{id:t.item.data("sek-id"),level:"section",newOrder:o,from_location:a,to_location:i})},over:function(e,t){t.placeholder.addClass("sek-sortable-section-over")},out:function(e,t){t.placeholder.removeClass("sek-sortable-section-over")}}))})},makeColumnsSortableInSektion:function(e){var a=this,t=c.extend(!0,{},a.sortableDefaultParams);c('[data-sek-id="'+e+'"]').find(".sek-sektion-inner").first().sortable(k.extend(t,{handle:".sek-move-column",connectWith:".sek-sektion-inner",remove:function(e,t){return $targetSektionCandidate=t.item.closest('[data-sek-level="section"]'),!(0<$targetSektionCandidate.length&&12<$targetSektionCandidate.find(".sek-sektion-inner").first().children('[data-sek-level="column"]').length)||(l.preview.send("sek-notify",{message:sekPreviewLocalized.i18n["You've reached the maximum number of columns allowed in this section."]}),!1)},start:function(e,t){startOrder=[],newOrder=[],from_sektion=t.item.closest('[data-sek-level="section"]').data("sek-id"),t.item.closest('[data-sek-level="section"]').find(".sek-sektion-inner").first().children('[data-sek-level="column"]').each(function(){startOrder.push(c(this).data("sek-id"))}),k.isEmpty(startOrder)&&a.errare("column sortable => startOrder should not be empty")},stop:function(e,t){$targetSektion=t.item.closest('[data-sek-level="section"]'),to_sektion=$targetSektion.data("sek-id"),$targetSektion.find(".sek-sektion-inner").first().children('[data-sek-level="column"]').each(function(){newOrder.push(c(this).data("sek-id"))}),k.isEmpty(newOrder)?a.errare("column sortable =>  newOrder should not be empty"):k.isEqual(newOrder,startOrder)&&to_sektion===from_sektion?sekPreviewLocalized.isDevMode&&a.errare("preview => makeModulesSortableInColumn => start and stop positions are identical"):l.preview.send("sek-move",{id:t.item.data("sek-id"),level:"column",newOrder:newOrder,from_sektion:from_sektion,to_sektion:to_sektion})}}))},makeModulesSortableInColumn:function(e){var a,i,n,s,t,o=[],r=[],d=this;t=c.extend(!0,{},d.sortableDefaultParams),c('[data-sek-id="'+e+'"]').find(".sek-column-inner").first().sortable(k.extend(t,{handle:".sek-move-module",connectWith:".sek-column-inner",over:function(e,t){c('[data-sek-level="location"]').find(".sek-sortable-overing").each(function(){c(this).removeClass("sek-sortable-overing")}),c(e.target).addClass("sek-sortable-overing")},start:function(e,t){o=[],r=[],c("body").addClass("sek-dragging-element"),i=t.item.closest('[data-sek-level="column"]').data("sek-id"),a=t.item.closest('[data-sek-level="section"]').data("sek-id"),t.item.closest('[data-sek-level="column"]').find(".sek-column-inner").first().children('[data-sek-level="module"]').each(function(){o.push(c(this).data("sek-id"))}),k.isEmpty(o)&&d.errare("makeModulesSortableInColumn => startOrder should not be empty")},stop:function(e,t){s=t.item.closest('[data-sek-level="column"]'),n=s.data("sek-id"),s.find(".sek-column-inner").first().children("[data-sek-id]").each(function(){r.push(c(this).data("sek-id"))}),k.isEmpty(r)?d.errare("makeModulesSortableInColumn => newOrder should not be empty"):k.isEqual(r,o)&&n===i?d.errare("preview => makeModulesSortableInColumn => start and stop positions are identical"):(l.preview.send("sek-move",{id:t.item.data("sek-id"),level:"module",newOrder:r,from_column:i,to_column:n,from_sektion:a,to_sektion:t.item.closest('[data-sek-level="section"]').data("sek-id")}),c("body").removeClass("sek-dragging-element"))}}))}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(l,c,k){c.extend(SekPreviewPrototype,{setupResizable:function(){var t=this;return c(".sektion-wrapper").find('div[data-sek-level="section"]').each(function(){t.maybeMakeColumnResizableInSektion.call(this)}),c("body").on("sek-modules-refreshed sek-columns-refreshed",'div[data-sek-level="section"]',function(e){t.maybeMakeColumnResizableInSektion.call(this)}),this},maybeMakeColumnResizableInSektion:function(){var a,i,n,s,o,r,d,e=c(this).find(".sek-sektion-inner").first().children('div[data-sek-level="column"]');e.length<2||e.each(function(){c(this).resizable({resize:function(e,t){c(".sektion-wrapper").data("sek-resizing-columns",!0)},start:function(e,t){if(a=t.element.closest('div[data-sek-level="section"]'),a.data("sek-id"),i=a.find(".sek-sektion-inner")[0].getBoundingClientRect().width,!((o=a.find(".sek-sektion-inner").first().children('div[data-sek-level="column"]').length)<2)){if((n=t.element.closest('div[data-sek-level="column"]')).length<1)throw new Error("ERROR => resizable => No valid level dom element found");d=n.index()+1==o,r=d?n.prev():n.next(),c(".sektion-wrapper").data("sek-resizing-columns",!0),k.delay(function(){c(".sektion-wrapper").data("sek-resizing-columns",!1)},3e3)}},stop:function(e,t){if(!(o<2)){if(n.length<1)throw new Error("ERROR => resizable => No valid level dom element found");n.css({width:"",height:""}),s=(parseFloat(t.size.width)/parseFloat(i)*100).toFixed(3),l.preview.send("sek-resize-columns",{action:"sek-resize-columns",level:n.data("sek-level"),in_sektion:a.data("sek-id"),id:n.data("sek-id"),resized_column:n.data("sek-id"),sister_column:r.data("sek-id"),resizedColumnWidthInPercent:s,col_number:o}),c(".sektion-wrapper").data("sek-resizing-columns",!1)}},helper:"ui-resizable-helper",handles:"e"});var e=c(this);k.delay(function(){e.find(".ui-resizable-handle").find(".fa-arrows-alt-h").length<1&&e.find(".ui-resizable-handle").append('<i class="fas fa-arrows-alt-h"></i>')},500)})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,u,d){u.extend(SekPreviewPrototype,{setupUiHoverVisibility:function(){var i,n,s,o,t,r=this;u("body").on("mouseenter","[data-sek-level]",function(e){if("location"!=(n=u(this).data("sek-level"))&&!(0<(o=u(this)).children(".sek-dyn-ui-wrapper").length&&!0!==o.data("UIisFadingOut"))){switch(s={id:o.data("sek-id"),level:o.data("sek-level")},n){case"section":s=d.extend(s,{is_last_possible_section:!0===u(this).data("sek-is-nested"),can_have_more_columns:u(this).find(".sek-sektion-inner").first().children('div[data-sek-level="column"]').length<12});break;case"column":var t=u(this).closest('div[data-sek-level="section"]');s=d.extend(s,{parent_can_have_more_columns:t.find(".sek-sektion-inner").first().children('div[data-sek-level="column"]').length<12,parent_is_single_column:t.find(".sek-sektion-inner").first().children('div[data-sek-level="column"]').length<2,parent_is_last_allowed_nested:!0===t.data("sek-is-nested")});break;case"module":var a=r.getRegisteredModuleProperty(o.data("sek-module-type"),"name");s=d.extend(s,{module_name:"not_set"!=a?a:""})}!0===u(".sektion-wrapper").data("sek-resizing-columns")&&d.contains(["column","module"],n)||(i=r.parseTemplate("#sek-dyn-ui-tmpl-"+n),u.when(u(this).prepend(i(s))).done(function(){o.find(".sek-dyn-ui-wrapper").stop(!0,!0).fadeIn({duration:150,complete:function(){}})}))}}).on("mouseleave","[data-sek-level]",function(e){(o=u(this)).data("UIisFadingOut",!0),o.children(".sek-dyn-ui-wrapper").stop(!0,!0).fadeOut({duration:150,complete:function(){u(this).remove(),o.data("UIisFadingOut",!1)}})}),u("body").on("mouseenter",".sek-wp-content-wrapper",function(e){0<(t=u(this)).children(".sek-dyn-ui-wrapper").length&&!0!==t.data("UIisFadingOut")||(i=r.parseTemplate("#sek-dyn-ui-tmpl-wp-content"),u.when(t.prepend(i({}))).done(function(){t.find(".sek-dyn-ui-wrapper").stop(!0,!0).fadeIn({duration:150,complete:function(){}})}))}).on("mouseleave",".sek-wp-content-wrapper",function(e){u(this).data("UIisFadingOut",!0),t=u(this),u(this).children(".sek-dyn-ui-wrapper").stop(!0,!0).fadeOut({duration:150,complete:function(){u(this).remove(),t.data("UIisFadingOut",!1)}})});return r.mouseMovedRecently=new e.Value({}),r.mouseMovedRecently.bind(function(e){var k;d.isEmpty(e)?u("body").stop(!0,!0).find(".sek-add-content-button").each(function(){u(this).fadeOut({duration:200,complete:function(){u(this).remove()}})}):(u("body").find('div[data-sek-level="location"]').each(function(){$sectionCollection=u(this).children('div[data-sek-level="section"]'),i=r.parseTemplate("#sek-tmpl-add-content-button");var e,t=u(this).data("sek-id");$sectionCollection.each(function(){0<u(this).find(".sek-add-content-button").length||(u.when(u(this).prepend(i({location:t}))).done(function(){e=u(this).find(".sek-add-content-button"),u(this).data("sek-id")&&e.attr("data-sek-before-section",u(this).data("sek-id")),e.fadeIn(300)}),$sectionCollection.length==u(this).index()+1&&u.when(u(this).append(i({is_last:!0,location:t}))).done(function(){e=u(this).find(".sek-add-content-button").last(),u(this).data("sek-id")&&e.attr("data-sek-after-section",u(this).data("sek-id")),e.fadeIn(300)}))})}),u(".sek-empty-location-placeholder").each(function(){0<u(this).find(".sek-add-content-button").length||u.when(u(this).append(i({location:u(this).closest('div[data-sek-level="location"]').data("sek-id")}))).done(function(){$btn_el=u(this).find(".sek-add-content-button"),$btn_el.attr("data-sek-is-first-section",!0),$btn_el.fadeIn(300)})}),k=e,u("body").find(".sek-add-content-button").each(function(){var e=u(this)[0].getBoundingClientRect(),t=k.y,a=k.x,i=Math.abs(t-e.bottom),n=Math.abs(e.top-t),s=a-e.right,o=e.left-a,r=i<40||n<40,d=0<s&&s<40||0<o&&o<40,l=a<=e.right&&e.left<=a,c=t<=e.top&&e.bottom<=t;u(this).toggleClass("sek-mouse-is-close",(r||c)&&(d||l))}))}),u(window).on("mousemove scroll",d.throttle(function(e){r.mouseMovedRecently({x:e.clientX,y:e.clientY}),clearTimeout(u.data(this,"_scroll_move_timer_")),u.data(this,"_scroll_move_timer_",setTimeout(function(){r.mouseMovedRecently.set({})},4e3))},50)),e.preview.bind("sek-drag-start",function(){r.mouseMovedRecently.set({})}),this}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(u,p,m){p.extend(SekPreviewPrototype,{scheduleUiClickReactions:function(){var k=this;p("body").on("click",function(e){var t,a=p(e.target),i=a.closest('[data-sek-level="location"]'),n=a.closest("[data-sek-level]"),s=a.closest("[data-sek-click-on]"),o=i.data("sek-id"),r=n.data("sek-level"),d=n.data("sek-id");switch("add-content"==a.data("sek-click-on")||0<a.closest("[data-sek-click-on]").length&&"add-content"==a.closest("[data-sek-click-on]").data("sek-click-on")?"addContentButton":!m.isEmpty(a.data("sek-click-on"))||0<s.length?"UIIcon":"module"==n.data("sek-level")?"moduleWrapper":"column"==n.data("sek-level")&&!0===n.data("sek-no-modules")?"noModulesColumn":"column"==n.data("sek-level")?"columnOutsideModules":"section"==n.data("sek-level")?"sectionOutsideColumns":m.isEmpty(a.data("sek-add"))?a.hasClass("sek-to-json")?"sekToJson":a.hasClass("sek-wp-content-wrapper")||a.hasClass("sek-wp-content-dyn-ui")?"wpContent":a.hasClass("sek-edit-wp-content")?"editWpContent":"inactiveZone":"addSektion"){case"addContentButton":var l=!0===a.closest("[data-sek-is-first-section]").data("sek-is-first-section");u.preview.send("sek-add-section",{location:o,level:"section",before_section:a.closest("[data-sek-before-section]").data("sek-before-section"),after_section:a.closest("[data-sek-after-section]").data("sek-after-section"),is_first_section:l,send_to_preview:!l}),k.mayBePrintLoader({loader_located_in_level_id:o});break;case"UIIcon":if(n.length<1)throw new Error("ERROR => sek-front-preview => No valid level dom element found");if(t=a.closest("[data-sek-click-on]").data("sek-click-on"),m.isEmpty(t))throw new Error("Invalid action");if(m.isEmpty(r)||m.isEmpty(d))throw new Error("ERROR => sek-front-preview => No valid level id found");k._send_(a,{action:t,location:o,level:r,id:d}),m.contains(["add-section","add-column","remove","duplicate"],t)&&k.mayBePrintLoader({element:a,action:t,level:r});break;case"moduleWrapper":if(0<a.parent(".sek-dyn-ui-icons").length)return;k._send_(a,{action:"edit-module",level:r,id:d});break;case"noModulesColumn":if(0<a.parent(".sek-dyn-ui-icons").length)return;k._send_(a,{action:"pick-module",level:r,id:d});break;case"columnOutsideModules":case"sectionOutsideColumns":k._send_(a,{action:"edit-options",location:o,level:r,id:d});break;case"addSektion":u.preview.send("sek-add-section",{location:o,level:a.data("sek-add")});break;case"sekToJson":u.preview.send("sek-to-json",{id:d});break;case"wpContent":u.preview.send("sek-notify",{type:"info",duration:8e3,message:sekPreviewLocalized.i18n["This content has been created with the WordPress editor."]});break;case"editWpContent":var c=a.closest("[data-sek-wp-edit-link]").data("sek-wp-edit-link");m.isEmpty(c)||window.open(c,"_blank");break;case"inactiveZone":u.preview.send("sek-click-on-inactive-zone")}})},_send_:function(e,t){u.preview.send("sek-"+t.action,{location:t.location,level:t.level,module_type:"module"==t.level?e.closest('div[data-sek-level="module"]').data("sek-module-type"):"",id:t.id,in_column:0<e.closest('div[data-sek-level="column"]').length?e.closest('div[data-sek-level="column"]').data("sek-id"):"",in_sektion:0<e.closest('div[data-sek-level="section"]').length?e.closest('div[data-sek-level="section"]').data("sek-id"):"",clicked_input_type:0<e.closest("div[data-sek-input-type]").length?e.closest("div[data-sek-input-type]").data("sek-input-type"):"",clicked_input_id:0<e.closest("div[data-sek-input-id]").length?e.closest("div[data-sek-input-id]").data("sek-input-id"):""})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,n,s){n.extend(SekPreviewPrototype,{setupLoader:function(){var t=this;this._css_loader_html='<div class="sek-css-loader sek-mr-loader" style="display:none"><div></div><div></div><div></div></div>',n("body").on("sek-modules-refreshed sek-columns-refreshed sek-section-added sek-level-refreshed",function(e){t.cleanLoader()})},mayBePrintLoader:function(e){var t=this,a=e.loader_located_in_level_id;if(s.isEmpty(a)){if(e.element.length<1)return void t.errare("::mayBePrintLoader => the provided params.element does not exist in the DOM.");if(s.isEmpty(e.action))return void t.errare("::mayBePrintLoader => missing level param.");switch(e.action){case"add-column":a=e.element.closest('[data-sek-level="section"]').data("sek-id");break;case"add-section":a=e.element.closest('[data-sek-level="column"]').data("sek-id");break;case"duplicate":if(s.isEmpty(e.level)){t.errare("::mayBePrintLoader => missing level param.");break}switch(e.level){case"module":a=e.element.closest('[data-sek-level="column"]').data("sek-id");break;case"column":a=e.element.closest('[data-sek-level="section"]').data("sek-id");break;case"section":a=e.element.closest('[data-sek-level="location"]').data("sek-id");break;case"default":t.errare("::mayBePrintLoader => unrecognized level param.",e.level)}break;case"remove":switch(e.level){case"module":a=e.element.closest('[data-sek-level="column"]').data("sek-id");break;case"column":a=e.element.closest('[data-sek-level="section"]').data("sek-id");break;case"section":a=e.element.closest('[data-sek-level="location"]').data("sek-id")}break;case"sek-add-module":a=e.loader_located_in_level_id;break;default:t.infoLog("::mayBePrintLoader => unrecognized action param.",e.action)}}if(!s.isEmpty(a)){var i=n('[data-sek-id="'+a+'"]');0<i.length&&n(".sek-level-clone ").length<1&&($levelClone=n("<div>",{class:"sek-level-clone"}),i.find("[data-sek-level]").each(function(){n(this).addClass("sek-refreshing")}),i.prepend($levelClone),$levelClone.css({width:i.outerWidth()+"px",height:i.outerHeight()+"px"}).append(t._css_loader_html).find(".sek-css-loader").fadeIn("fast"),clearTimeout(n.data(this,"_nimble_loader_active_timer_")),n.data(this,"_nimble_loader_active_timer_",setTimeout(function(){t.cleanLoader()},4e3)))}},cleanLoader:function(){n(".sek-level-clone").remove(),n("[data-sek-level]").each(function(){n(this).removeClass("sek-refreshing")})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(o,r,d){r.extend(SekPreviewPrototype,{schedulePanelMsgReactions:function(){var s=this,e={"sek-add-section":"ajaxAddSektion","sek-add-content-in-new-sektion":"ajaxAddSektion","sek-add-column":"ajaxRefreshColumns","sek-add-module":"ajaxRefreshModulesAndNestedSections","sek-remove":function(e){var t,a=e.apiParams.id,i=r('div[data-sek-id="'+a+'"]');switch(e.apiParams.action){case"sek-remove-section":!0===e.apiParams.is_nested?t=s.ajaxRefreshModulesAndNestedSections(e):((d.isEmpty(a)||i.length<1)&&s.errare("reactToPanelMsg => sek-remove => invalid candidate id => ",a),r("body").find(i).remove(),r('[data-sek-id="'+e.apiParams.location+'"]').trigger("sek-level-refreshed"));break;case"sek-remove-column":t=s.ajaxRefreshColumns(e);break;case"sek-remove-module":t=s.ajaxRefreshModulesAndNestedSections(e)}return d.isEmpty(t)?r.Deferred(function(){this.resolve()}):t},"sek-duplicate":function(e){var t;switch(e.apiParams.action){case"sek-duplicate-section":e.apiParams.id=e.cloneId,t=s.ajaxAddSektion(e);break;case"sek-duplicate-column":e.apiParams.id=e.cloneId,t=s.ajaxRefreshColumns(e);break;case"sek-duplicate-module":e.apiParams.id=e.cloneId,t=s.ajaxRefreshModulesAndNestedSections(e)}return t},"sek-refresh-level":function(n){return s.mayBePrintLoader({loader_located_in_level_id:n.apiParams.id}),s.doAjax({skope_id:n.skope_id,action:"sek_get_content",id:n.apiParams.id,level:n.apiParams.level,sek_action:n.apiParams.action}).fail(function(e){s.errare("ERROR reactToPanelMsg => sek-refresh-level => ",e)}).done(function(e){var t='<span class="sek-placeholder" data-sek-placeholder-for="'+n.apiParams.id+'"></span>',a=r('div[data-sek-id="'+n.apiParams.id+'"]');if(a.length<1)s.errare("reactToPanelMsg => sek-refresh-level ajax done => the level to refresh is not rendered in the page",e);else{a.before(t);var i=r('[data-sek-placeholder-for="'+n.apiParams.id+'"]');a.remove(),i.after(e.data),i.remove(),r('[data-sek-id="'+n.apiParams.id+'"]').trigger("sek-refresh-level",{level:n.apiParams.level,id:n.apiParams.id})}})},"sek-refresh-stylesheet":"ajaxRefreshStylesheet","sek-move":function(e){switch(e.apiParams.action){case"sek-move-column":if(e.apiParams.from_sektion!=e.apiParams.to_sektion){var t=r.extend(!0,{},e),a=r.extend(!0,{},e);r('[data-sek-id="'+e.apiParams.from_sektion+'"]',".sektion-wrapper").find('div[data-sek-level="column"]').length<1?o.preview.send("sek-add-column",{in_sektion:e.apiParams.from_sektion,autofocus:!1}):(t.apiParams=d.extend(t.apiParams,{in_sektion:e.apiParams.from_sektion,action:"sek-refresh-columns-in-sektion"}),s.ajaxRefreshColumns(t)),a.apiParams=d.extend(a.apiParams,{in_sektion:e.apiParams.to_sektion,action:"sek-refresh-columns-in-sektion"}),s.ajaxRefreshColumns(a)}break;case"sek-move-module":var i=r.extend(!0,{},e),n=r.extend(!0,{},e);i.apiParams.from_column!=i.apiParams.to_column&&(i.apiParams=d.extend(i.apiParams,{in_column:i.apiParams.from_column,in_sektion:i.apiParams.from_sektion,action:"sek-refresh-modules-in-column"}),s.ajaxRefreshModulesAndNestedSections(i)),e.apiParams=d.extend(n.apiParams,{in_column:n.apiParams.to_column,in_sektion:n.apiParams.to_sektion,action:"sek-refresh-modules-in-column"}),s.ajaxRefreshModulesAndNestedSections(n),r('[data-sek-id="'+e.apiParams.to_column+'"]',".sektion-wrapper").find(".sek-column-inner").sortable("refresh")}},"sek-resize-columns":"ajaxResizeColumns","sek-edit-options":function(e){s.activeLevelUI(e.uiParams.id)},"sek-edit-module":function(e){s.activeLevelUI(e.uiParams.id)},"sek-drag-start":function(e){var t=1;r(".sektion-wrapper").children('[data-sek-level="section"]').each(function(){r('[data-drop-zone-before-section="'+r(this).data("sek-id")+'"]').length<1&&r(this).before('<div class="sek-content-'+e.type+'-drop-zone sek-dynamic-drop-zone sek-drop-zone" data-sek-location="between-sections" data-drop-zone-before-section="'+r(this).data("sek-id")+'"></div>'),t==r(".sektion-wrapper").children('[data-sek-level="section"]').length&&r(this).after('<div class="sek-content-'+e.type+'-drop-zone sek-dynamic-drop-zone sek-drop-zone" data-sek-location="between-sections" data-drop-zone-after-section="'+r(this).data("sek-id")+'"></div>'),t++}),r(".sek-empty-location-placeholder").each(function(){r.when(r(this).append('<div class="sek-content-'+e.type+'-drop-zone sek-dynamic-drop-zone sek-drop-zone" data-sek-location="in-empty-location"></div>'))}),"module"==e.type&&r('[data-sek-level="column"]').each(function(){var e=r(this).find('[data-sek-level="module"]'),t=1;e.each(function(){r('[data-drop-zone-before-module="'+r(this).data("sek-id")+'"]').length<1&&r(this).before('<div class="sek-content-module-drop-zone sek-dynamic-drop-zone sek-drop-zone" data-sek-location="between-modules" data-drop-zone-before-module="'+r(this).data("sek-id")+'"></div>'),t==e.length&&r('[data-drop-zone-after-module="'+r(this).data("sek-id")+'"]').length<1&&r(this).after('<div class="sek-content-module-drop-zone sek-dynamic-drop-zone sek-drop-zone" data-sek-location="between-modules" data-drop-zone-after-module="'+r(this).data("sek-id")+'"></div>'),t++})}),r("body").addClass("sek-dragging"),d.delay(function(){r(".sek-dynamic-drop-zone").css({opacity:1})},100)},"sek-drag-stop":function(e){r("body").removeClass("sek-dragging"),r(".sortable-placeholder").remove(),r(".sek-dynamic-drop-zone").remove()},"sek-focus-on":function(e){0<r('div[data-sek-id="'+e.id+'"]').length&&r("html, body").animate({scrollTop:r('div[data-sek-id="'+e.id+'"]').offset().top-100},"slow")}};d.each(e,function(t,a){o.preview.bind(a,function(e){if(e=d.extend({skope_id:"",apiParams:{},uiParams:{}},e||{}),d.isFunction(t))try{r.when(t(e)).done(function(){o.preview.send([a,"done"].join("_"),e)}).fail(function(){o.preview.send("sek-notify",{type:"error",duration:1e4,message:sekPreviewLocalized.i18n["Something went wrong, please refresh this page."]})}).then(function(){o.preview.trigger("control-panel-requested-action-done",{action:a,args:e})})}catch(e){s.errare("reactToPanelMsg => Error when firing the callback of "+a,e)}else try{r.when(s[t].call(s,e)).done(function(){o.preview.send([a,"done"].join("_"),e)}).fail(function(){o.preview.send("sek-notify",{type:"error",duration:1e4,message:sekPreviewLocalized.i18n["Something went wrong, please refresh this page."]})}).then(function(){o.preview.trigger("control-panel-requested-action-done",{action:a,args:e})})}catch(e){s.errare("reactToPanelMsg => Error when firing the callback of "+a,e)}})})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,s,o){s.extend(SekPreviewPrototype,{ajaxAddSektion:function(i){var n=this;return n.doAjax({action:"sek_get_content",id:i.apiParams.id,in_sektion:i.apiParams.in_sektion,in_column:i.apiParams.in_column,skope_id:i.skope_id,sek_action:i.apiParams.action,is_nested:i.apiParams.is_nested}).done(function(e){var t;if(i.apiParams.is_nested){(t=s(".sektion-wrapper").find('div[data-sek-id="'+i.apiParams.in_column+'"]')).length<1&&n.errare("preview => reactToPanelMsg => sek-add-column => no DOM node for parent column => ",i.apiParams.in_column);var a='<span class="sek-placeholder" data-sek-placeholder-for="'+i.apiParams.in_column+'"></span>';t.before(a),t.remove(),s(".sektion-wrapper").find(".sek-placeholder").after(e.data),s(".sektion-wrapper").find(".sek-placeholder").remove()}else"sek-duplicate-section"!=i.apiParams.action||o.isEmpty(i.cloneId)?($beforeCandidate=s('.sektion-wrapper[data-sek-id="'+i.apiParams.location+'"]').find('div[data-sek-id="'+i.apiParams.before_section+'"]'),$afterCandidate=s('.sektion-wrapper[data-sek-id="'+i.apiParams.location+'"]').find('div[data-sek-id="'+i.apiParams.after_section+'"]'),!o.isEmpty(i.apiParams.before_section)&&0<$beforeCandidate.length?$beforeCandidate.before(e.data):!o.isEmpty(i.apiParams.after_section)&&0<$afterCandidate.length?$afterCandidate.after(e.data):s('[data-sek-id="'+i.apiParams.location+'"]').append(e.data)):s(".sektion-wrapper").find('div[data-sek-id="'+i.apiParams.in_sektion+'"]').after(e.data);"sek-duplicate-section"==i.apiParams.action&&s('div[data-sek-id="'+i.cloneId+'"]',".sektion-wrapper").each(function(){s(this).trigger("sek-columns-refreshed")}),i.apiParams.is_nested&&(n.makeModulesSortableInColumn(i.apiParams.in_column),s(".sektion-wrapper").find('div[data-sek-id="'+i.apiParams.in_sektion+'"]').each(function(){n.maybeMakeColumnResizableInSektion.call(this)})),i.cloneId&&s('div[data-sek-id="'+i.cloneId+'"]').trigger("sek-section-added",i),s('div[data-sek-id="'+i.apiParams.id+'"]').trigger("sek-section-added",i)}).fail(function(e){n.errare("ERROR in sek_get_html_for_injection ? ",e)})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,s,t){s.extend(SekPreviewPrototype,{ajaxRefreshColumns:function(i){var n=this;return n.doAjax({action:"sek_get_content",id:i.apiParams.id,in_sektion:i.apiParams.in_sektion,skope_id:i.skope_id,sek_action:i.apiParams.action}).done(function(e){var t=s('div[data-sek-id="'+i.apiParams.in_sektion+'"]');t.length<1&&n.errare("reactToPanelMsg => "+i.apiParams.action+" => no DOM node for parent sektion => ",i.apiParams.in_sektion);var a='<span class="sek-placeholder" data-sek-placeholder-for="'+i.apiParams.in_sektion+'"></span>';t.before(a),t.remove(),s(".sektion-wrapper").find(".sek-placeholder").after(e.data),s(".sektion-wrapper").find(".sek-placeholder").remove(),n.doAjax({action:"sek_get_content",skope_id:i.skope_id,sek_action:"sek-refresh-stylesheet"}).done(function(e){n.appendDynStyleSheet(i.skope_id,e.data)}).fail(function(e){console.log("sek-refresh-stylesheet fail !")}),s('div[data-sek-id="'+i.apiParams.in_sektion+'"]').trigger("sek-columns-refreshed")}).fail(function(e){n.errare("ERROR reactToPanelMsg => sek-add-column => ",e)})},ajaxResizeColumns:function(t){var a=this;return a.mayBePrintLoader({loader_located_in_level_id:t.apiParams.in_sektion}),a.doAjax({action:"sek_get_content",resized_column:t.apiParams.resized_column,sister_column:t.apiParams.sister_column,skope_id:t.skope_id,sek_action:"sek-resize-columns"}).done(function(e){s('[data-sek-id="'+t.apiParams.resized_column+'"]').css({width:"",height:""}),a.appendDynStyleSheet(t.skope_id,e.data),s('div[data-sek-id="'+t.apiParams.in_sektion+'"]').trigger("sek-columns-refreshed")}).fail(function(e){a.errare("ERROR reactToPanelMsg => sek-resize-columns => ",e)})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,s,t){s.extend(SekPreviewPrototype,{ajaxRefreshModulesAndNestedSections:function(i){var n=this;return n.mayBePrintLoader({loader_located_in_level_id:i.apiParams.in_column}),n.doAjax({action:"sek_get_content",id:i.apiParams.id,in_sektion:i.apiParams.in_sektion,in_column:i.apiParams.in_column,skope_id:i.skope_id,sek_action:i.apiParams.action,is_nested:i.apiParams.is_nested}).done(function(e){var t=s('[data-sek-id="'+i.apiParams.in_column+'"]');t.length<1&&n.errare("reactToPanelMsg => ajaxRefreshModulesAndNestedSections => no DOM node for parent column => ",i.apiParams.in_column);var a='<span class="sek-placeholder" data-sek-placeholder-for="'+i.apiParams.in_column+'"></span>';t.before(a),t.remove(),s('[data-sek-placeholder-for="'+i.apiParams.in_column+'"]').after(e.data),s('[data-sek-placeholder-for="'+i.apiParams.in_column+'"]').remove(),s('[data-sek-id="'+i.apiParams.in_column+'"]').trigger("sek-modules-refreshed")}).fail(function(e){n.errare("ERROR reactToPanelMsg => sek-add-module => ",e)})}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,n,s){n.extend(SekPreviewPrototype,{ajaxRefreshStylesheet:function(t){var a=this;return a.doAjax({action:"sek_get_content",skope_id:t.skope_id,sek_action:"sek-refresh-stylesheet"}).done(function(e){a.appendDynStyleSheet(t.skope_id,e.data)}).fail(function(e){a.errare("sek-refresh-stylesheet fail !")})},appendDynStyleSheet:function(e,t){var a="#sek-"+e,i="#sek-gfonts-"+e;0<n("head").find(a).length&&n("head").find(a).remove(),0<n("head").find(i).length&&n("head").find(i).remove(),n("head").append(t),!s.isEmpty(t)&&n("head").find(a).length<1?this.errare("sek-preview => problem when printing the dynamic inline style for : "+a):n("head").find(a).attr("sek-data-origin","customizer")}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,o,r){o.extend(SekPreviewPrototype,{parseTemplate:r.memoize(function(t){var a,i=this,n={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(e){if(o(t).length<1)return i.errare("preview => parseTemplate => the requested tmpl does not exist =>"+t),"";try{a=a||r.template(o(t).html(),n)}catch(e){i.errare("preview => parseTemplate => problem when parsing tmpl =>"+t,e)}return a(e)}}),_prettyPrintLog:function(e){e=r.extend({bgCol:"#5ed1f5",textCol:"#000",consoleArguments:[]},e);var t,a=Array.from(e.consoleArguments);return a=r.isEmpty(r.filter(a,function(e){return!r.isString(e)}))?a.join(" "):JSON.stringify(a.join(" ")),["%c "+(t=a,r.isString(t)?300<t.length?t.substr(0,299)+"...":t:""),["background:"+e.bgCol,"color:"+e.textCol,"display: block;"].join(";")]},_wrapLogInsideTags:function(e,t,a){r.isUndefined(console)&&"function"!=typeof window.console.log||(sekPreviewLocalized.isDevMode?r.isUndefined(t)?console.log.apply(console,this._prettyPrintLog({bgCol:a,textCol:"#000",consoleArguments:["<"+e+">"]})):(console.log.apply(console,this._prettyPrintLog({bgCol:a,textCol:"#000",consoleArguments:["<"+e+">"]})),console.log(t),console.log.apply(console,this._prettyPrintLog({bgCol:a,textCol:"#000",consoleArguments:["</"+e+">"]}))):console.log.apply(console,this._prettyPrintLog({bgCol:a,textCol:"#000",consoleArguments:[e]})))},errare:function(e,t){this._wrapLogInsideTags(e,t,"#ffd5a0")},infoLog:function(e,t){this._wrapLogInsideTags(e,t,"#5ed1f5")},doAjax:function(e){var t=this,a=(e=e||(r.isObject(e)?e:{})).ajaxUrl||sekPreviewLocalized.ajaxUrl,i=sekPreviewLocalized.frontNonce,n=o.Deferred(),s=r.extend({action:"",withNonce:!1},e);return"https:"==document.location.protocol&&(a=a.replace("http://","https://")),r.isEmpty(s.action)||!r.isString(s.action)?(t.errare("self.doAjax : unproper action provided"),n.resolve().promise()):(s[i.id]=i.handle,!r.isObject(i)||r.isUndefined(i.id)||r.isUndefined(i.handle)?(t.errare("self.doAjax : unproper nonce"),n.resolve().promise()):(o.post(a,s).done(function(e){"0"!==e&&"-1"!==e&&!1!==e.success||(t.errare("self.doAjax : done ajax error for action : "+s.action,e),n.reject(e)),n.resolve(e)}).fail(function(e){t.errare("self.doAjax : failed ajax error for : "+s.action,e),n.reject(e)}),n.promise()))},isModuleRegistered:function(e){return sekPreviewLocalized.registeredModules&&!r.isUndefined(sekPreviewLocalized.registeredModules[e])},getRegisteredModuleProperty:function(e,t){return this.isModuleRegistered(e)?sekPreviewLocalized.registeredModules[e][t]:"not_set"}})}(wp.customize,jQuery,_);SekPreviewPrototype=SekPreviewPrototype||{};!function(e,t,a){t.extend(SekPreviewPrototype,e.Events);var i=e.Class.extend(SekPreviewPrototype);e.bind("preview-ready",function(){e.preview.bind("active",function(){try{e.sekPreview=new i}catch(e){SekPreviewPrototype.errare("SekPreviewConstructor => problem on instantiation",e)}})})}(wp.customize,jQuery,_);